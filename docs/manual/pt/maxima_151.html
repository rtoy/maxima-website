<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Análise gráfica de sistemas dinâmicos discretos (Manual do Maxima 5.47.0)</title>

<meta name="description" content="Análise gráfica de sistemas dinâmicos discretos (Manual do Maxima 5.47.0)">
<meta name="keywords" content="Análise gráfica de sistemas dinâmicos discretos (Manual do Maxima 5.47.0)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="maxima_toc.html" rel="start" title="Top">
<link href="maxima_218.html" rel="index" title="Índice de Funções e Variáveis">
<link href="maxima_toc.html#SEC_Contents" rel="contents" title="Sum&aacute;rio">
<link href="maxima_149.html" rel="up" title="dynamics">
<link href="maxima_152.html" rel="next" title="Visualização usando VTK">
<link href="maxima_150.html" rel="prev" title="O pacote dynamics">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
body {color: black; background: white;  margin-left: 8%; margin-right: 13%;
      font-family: "FreeSans", sans-serif}
h1 {font-size: 150%; font-family: "FreeSans", sans-serif}
h2 {font-size: 125%; font-family: "FreeSans", sans-serif}
h3 {font-size: 100%; font-family: "FreeSans", sans-serif}
a[href] {color: rgb(0,0,255); text-decoration: none;}
a[href]:hover {background: rgb(220,220,220);}
div.textbox {border: solid; border-width: thin; padding-top: 1em;
    padding-bottom: 1em; padding-left: 2em; padding-right: 2em}
div.titlebox {border: none; padding-top: 1em; padding-bottom: 1em;
    padding-left: 2em; padding-right: 2em; background: rgb(200,255,255);
    font-family: sans-serif}
div.synopsisbox {
    border: none; padding-top: 1em; padding-bottom: 1em; padding-left: 2em;
    padding-right: 2em; background: rgb(255,220,255);}
pre.example {border: 1px solid rgb(180,180,180); padding-top: 1em;
    padding-bottom: 1em; padding-left: 1em; padding-right: 1em;
    background-color: rgb(238,238,255)}
div.spacerbox {border: none; padding-top: 2em; padding-bottom: 2em}
div.image {margin: 0; padding: 1em; text-align: center}
div.categorybox {border: 1px solid gray; padding-top: 1em; padding-bottom: 1em;
    padding-left: 1em; padding-right: 1em; background: rgb(247,242,220)}
img {max-width:80%; max-height: 80%; display: block; margin-left: auto; margin-right: auto}

-->
</style>

<link rel="icon" href="figures/favicon.ico">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6>"></script>

</head>

<body lang="pt">
<div class="section" id="An_00e1lise-gr_00e1fica-de-sistemas-din_00e2micos-discretos">
<div class="header">
<p>
Pr&oacute;ximo: <a href="maxima_152.html" accesskey="n" rel="next">Visualização usando VTK</a>, Anterior: <a href="maxima_150.html" accesskey="p" rel="prev">O pacote dynamics</a>, Acima: <a href="maxima_149.html" accesskey="u" rel="up">dynamics</a> &nbsp; [<a href="maxima_toc.html#SEC_Contents" title="Sum&aacute;rio" rel="contents">Conte&uacute;do</a>][<a href="maxima_218.html" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>]</p>
</div>
<span id="Analise-grafica-de-sistemas-dinamicos-discretos"></span><h3 class="section">47.2, Análise gráfica de sistemas dinâmicos discretos</h3>

<span id="Item_003a-dynamics_002fdeffn_002fchaosgame"></span><dl class="def">
<dt id="index-chaosgame"><span class="category">Função: </span><span><strong>chaosgame</strong> <em>(<code>[[</code><var>x1</var>, <var>y1</var><code>]</code>...<code>[</code><var>xm</var>, <var>ym</var><code>]]</code>, <code>[</code><var>x0</var>, <var>y0</var><code>]</code>, <var>b</var>, <var>n</var>, ...opções...);</em><a href='#index-chaosgame' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>Usa o método designado de <em>jogo do caos</em>, para produzir fractais:
desenha-se um ponto inicial (<var>x0</var>, <var>y0</var>) e logo escolhe-se
aleatoriamente um dos <var>m</var> pontos <code>[</code><var>x1</var>,
<var>y1</var><code>]</code>...<code>[</code><var>xm</var>, <var>ym</var><code>]</code>. A seguir,
desenha-se um novo ponto que estará no segmento entre o último ponto
desenhado e o ponto que se acabou de seleccionar aleatoriamente, a uma
distância do ponto seleccionado que será <var>b</var> vezes o comprimento
do segmento. O processo repete-se <var>n</var> vezes.
</p>
</dd></dl>

<span id="Item_003a-dynamics_002fdeffn_002fevolution"></span><dl class="def">
<dt id="index-evolution"><span class="category">Função: </span><span><strong>evolution</strong> <em>(<var>F</var>, <var>y0</var>, <var>n</var>,...opções...);</em><a href='#index-evolution' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>Desenha <var>n+1</var> pontos num gráfico bidimensional (série de tempo),
onde as coordenadas horizontais dos pontos são os números inteiros
0, 1, 2, ..., <var>n</var>, e as coordenadas verticais são os valores
<var>y(n)</var> correspondentes, obtidos a partir da relação
de recorrência
</p><div class="example">
<pre class="example">        y(n+1) = F(y(n))
</pre></div>

<p>Com valor inicial <var>y(0)</var> igual a <var>y0</var>. <var>F</var> deverá ser uma
expressão que dependa unicamente da variável <var>y</var> (e não de <var>n</var>),
<var>y0</var> deverá ser um número real e <var>n</var> um número inteiro positivo.
</p>
</dd></dl>

<span id="Item_003a-dynamics_002fdeffn_002fevolution2d"></span><dl class="def">
<dt id="index-evolution2d"><span class="category">Função: </span><span><strong>evolution2d</strong> <em>(<code>[</code><var>F</var>, <var>G</var><code>]</code>, <code>[</code><var>x0</var>, <var>y0</var><code>]</code>, <var>n</var>, ...opções...);</em><a href='#index-evolution2d' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>Mostra, num gráfico bidimensional, os primeiros <var>n+1</var> pontos da
sucessão definida a partir do sistema dinâmico discreto com
relações de recorrência:
</p><div class="example">
<pre class="example">        x(n+1) = F(x(n), y(n))    y(n+1) = G(x(n), y(n))
</pre></div>

<p>Com valores iniciais <var>x0</var> e <var>y0</var>. <var>F</var> e <var>G</var> deverão
ser duas expressões que dependam unicamente de <var>x</var> e <var>y</var>.
</p>
</dd></dl>

<span id="Item_003a-dynamics_002fdeffn_002fifs"></span><dl class="def">
<dt id="index-ifs"><span class="category">Função: </span><span><strong>ifs</strong> <em>(<code>[</code><var>r1</var>,...,<var>rm</var><code>]</code>,<code>[</code><var>A1</var>,...,<var>Am</var><code>]</code>, <code>[[</code><var>x1</var>,<var>y1</var><code>]</code>...<code>[</code><var>xm</var>, <var>ym</var><code>]]</code>, <code>[</code><var>x0</var>,<var>y0</var><code>]</code>,</em><a href='#index-ifs' class='copiable-anchor'> &para;</a></span></dt>
<dd><p><var>n</var>, ...opções...);
</p>
<p>Usa o método do Sistema de Funções Iteradas (IFS, em
inglês <em>Iterated Function System</em>). Esse método é semelhante
ao método descrito na função <code>chaosgame</code>, mas em
vez de aproximar o último ponto para ponto seleccionado
aleatoriamente, as duas coordenadas do último ponto multiplicam-se por
uma matriz 2 por 2 <var>Ai</var> correspondente ao ponto que tenha sido
escolhido aleatoriamente.
</p>
<p>A selecção aleatória de um dos <var>m</var> pontos
atractivos pode se realizada com uma função de
probabilidade não uniforme, definida com os pesos
<var>r1</var>,...,<var>rm</var>. Pesos esses que deverão ser dados em forma
acumulada; por exemplo, se quiser usar 3 pontos com probabilidades
0.2, 0.5 e 0.3, os pesos <var>r1</var>, <var>r2</var> e <var>r3</var> poderiam ser 2, 7
e 10, ou qualquer outro grupo de números que estejam na mesma
proporção.
</p>
</dd></dl>


<span id="Item_003a-dynamics_002fdeffn_002forbits"></span><dl class="def">
<dt id="index-orbits"><span class="category">Função: </span><span><strong>orbits</strong> <em>(<var>F</var>, <var>y0</var>, <var>n1</var>, <var>n2</var>, [<var>x</var>, <var>x0</var>, <var>xf</var>, <var>xstep</var>], ...opções...);</em><a href='#index-orbits' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>Desenha o diagrama de órbitas duma família de sistemas
dinâmicos discretos unidimensionais, com um parâmetro <var>x</var>; esse
tipo de diagrama usa-se para mostrar as bifurcações dum
sistema discreto unidimensional.
</p>
<p>A função <var>F(y)</var> define uma sequência que
começa com um valor inicial <var>y0</var>, igual que no caso da
função <code>evolution</code>, mas neste caso a
função também dependerá do parâmetro <var>x</var>, o
qual terá valores compreendidos no intervalo de <var>x0</var> a <var>xf</var>,
com incrementos <var>xstep</var>. Cada valor usado para o parâmetro <var>x</var>
apresenta-se no eixo horizontal. No eixo vertical apresentam-se <var>n2</var>
valores da sucessão <var>y(n1+1)</var>,..., <var>y(n1+n2+1)</var>, obtidos
após deixá-la evoluir durante <var>n1</var> iterações
iniciais.
</p>
</dd></dl>

<span id="Item_003a-dynamics_002fdeffn_002frk"></span><dl class="def">
<dt id="index-rk"><span class="category">Função: </span><span><strong>rk</strong> <em>(EDO, var, inicial, dominio)</em><a href='#index-rk' class='copiable-anchor'> &para;</a></span></dt>
<dt id="index-rk-1"><span class="category">Função: </span><span><strong>rk</strong> <em>([EDO1,...,EDOm], [v1,...,vm], [inic1,...,inicm], domínio)</em><a href='#index-rk-1' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>A primeira forma usa-se para resolver numericamente uma
equação diferencial ordinária de primeira ordem (EDO),
e a segunda forma resolve numericamente um sistema de <var>m</var> dessas
equações, usando o método de Runge-Kutta de quarta
ordem. <var>var</var> representa a variável dependente.  EDO deverá ser
uma expressão que dependa unicamente das variáveis independente e
dependente, e define a derivada da variável dependente em
função da variável independente.
</p>
<p>A variável independente representa-se com <var>domínio</var>,
que deverá ser uma lista com quatro elementos, como, por exemplo:
</p><div class="example">
<pre class="example">[t, 0, 10, 0.1]
</pre></div>
<p>o primeiro elemento da lista identifica a variável independente, os
segundo e terceiro elementos são os valores inicial e final para essa
variável, e o último elemento dá o valor dos incrementos que
deverão ser usados dentro desse intervalo.
</p>
<p>Se se estiverem a resolver <var>m</var> equações, deverá
haver <var>m</var> variáveis dependentes <var>v1</var>, <var>v2</var>, ...,
<var>vm</var>. Os valores iniciais para essas variáveis serão
<var>inic1</var>, <var>inic2</var>, ..., <var>inicm</var>. Continuará existindo
apenas uma variável independente, definida pela lista <var>domain</var>,
tal como no caso anterior. <var>EDO1</var>, ..., <var>EDOm</var> são as
expressões que definem as derivadas de cada uma das variáveis
dependentes, em função da variável independente. As
únicas variáveis que podem aparecer em cada uma dessas expressões
são a variável independente e qualquer uma das variáveis
dependentes. É importante que as derivadas <var>EDO1</var>, ..., <var>EDOm</var>
sejam colocadas na lista na mesma ordem em que forem agrupadas as
variáveis dependentes; por exemplo, o terceiro elemento da lista
será interpretado como a derivada da terceira variável dependente.
</p>
<p>O programa tenta integrar as equações desde o valor
inicial da variável independente, até o valor final, usando
incrementos fixos. Se em algum passo uma das variáveis dependentes
atingir um valor absoluto muito elevado, a integração
será interrompida nesse ponto. O resultado será uma lista com um
número de elementos igual ao número de iterações
realizadas. Cada elemento na lista de resultados é também uma lista
com <var>m</var>+1 elementos: o valor da variável independente, seguido dos
valores das variáveis dependentes nesse ponto.
</p>
</dd></dl>

<span id="Item_003a-dynamics_002fdeffn_002fstaircase"></span><dl class="def">
<dt id="index-staircase"><span class="category">Função: </span><span><strong>staircase</strong> <em>(<var>F</var>, <var>y0</var>, <var>n</var>, ...opções...);</em><a href='#index-staircase' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>Desenha um diagrama de degraus (ou diagrama de teia de aranha) para a
sucessão definida pela equação de recorrência
</p><div class="example">
<pre class="example">        y(n+1) = F(y(n))
</pre></div>

<p>A interpretação e valores permitidos dos parâmetros de
entrada é igual que para a função <code>evolution</code>. Um
diagrama de degraus consiste num gráfico da função
<var>F(y)</var>, junto com a recta <var>G(y)</var> <code>=</code>
<var>y</var>. Começa-se por desenhar um segmento vertical desde
o ponto (<var>y0</var>, <var>y0</var>) na recta, até o ponto de
intersecção com a função <var>F</var>. A
seguir, desde esse ponto desenha-se um segmento horizontal até o ponto
de intersecção com a recta, (<var>y1</var>, <var>y1</var>); o
processo repete-se <var>n</var> vezes até alcançar o ponto
(<var>yn</var>, <var>yn</var>).
</p>
</dd></dl>

<p><b>Opções</b>
</p>
<p>Cada opção é uma lista com dois ou mais elementos. O
primeiro elemento na lista é o nome da opção e os
restantes são os argumentos para essa opção.
</p>
<p>As opções aceites pelas funções
evolution, evolution2, staircase, orbits, ifs e chaosgame são as
seguintes:
</p>
<ul>
<li> <em>domain</em> especifica os valores mínimo y máximo da
variável independente para o gráfico da função <var>F</var>
representada por <code>staircase</code>.

</li><li> <em>pointsize</em> define o raio de cada ponto desenhado, em unidades de
pontos. O valor por omissão é 1.

</li><li> <em>xaxislabel</em> é o nome que será dado ao eixo horizontal.

</li><li> <em>xcenter</em> é a coordenada x do ponto que deverá aparecer no
centro do gráfico. Esta opção não é usada pela
função <code>orbits</code>.

</li><li> <em>xradius</em> é metade do comprimento do intervalo de valores de x que
serão representados. Esta opção não é usada pela
função <code>orbits</code>.

</li><li> <em>yaxislabel</em> é o nome que será dado ao eixo vertical.

</li><li> <em>ycenter</em> é a coordenada y do ponto que deverá aparecer no
centro do gráfico.

</li><li> <em>yradius</em> é metade do comprimento do intervalo de valores de y que
serão representados.

</li></ul>

<p>As opções aceites pelos programas juli
<b>Exemplos</b>
</p>
<p>Representação gráfica e diagrama de degraus da sequência:
2, cos(2), cos(cos(2)),...
</p>
<div class="example">
<pre class="example">(%i1) load(&quot;dynamics&quot;)$
(%i2) evolution(cos(y), 2, 11, [yaxislabel, &quot;y&quot;], [xaxislabel,&quot;n&quot;]);
(%i3) staircase(cos(y), 1, 11, [domain, 0, 1.2]);
</pre></div>

<img src="./figures/dynamics1.png" alt="./figures/dynamics1">
<img src="./figures/dynamics2.png" alt="./figures/dynamics2">

<p>Se o seu processador for lento, terá que reduzir o número de
iterações usado nos exemplos seguintes. E o valor de
<var>pointsize</var> que dá os melhores resultados dependerá do monitor e
da resolução usada. Terá que experimentar com
diferentes valores.
</p>
<p>Diagrama de órbitas para o mapa quadrático
</p><div class="example">
<pre class="example">        y(n+1) = x + y(n)^2
</pre></div>

<div class="example">
<pre class="example">(%i4) orbits(y^2+x, 0, 50, 200, [x, -2, 0.25, 0.01], [pointsize, 0.9]);
</pre></div>

<img src="./figures/dynamics3.png" alt="./figures/dynamics3">

<p>Para ampliar a região à volta da bifurcação na parte de
baixo, perto de x <code>=</code> -1.25, use o comando:
</p><div class="example">
<pre class="example">(%i5) orbits(x+y^2, 0, 100, 400, [x,-1,-1.53,-0.001], [pointsize,0.9],
             [ycenter,-1.2], [yradius,0.4]);
</pre></div>

<img src="./figures/dynamics4.png" alt="./figures/dynamics4">

<p>Evolução dum sistema em duas dimensões, que conduz a
um fractal:
</p>
<div class="example">
<pre class="example">(%i6) f: 0.6*x*(1+2*x)+0.8*y*(x-1)-y^2-0.9$
(%i7) g: 0.1*x*(1-6*x+4*y)+0.1*y*(1+9*y)-0.4$
(%i8) evolution2d([f,g],[-0.5,0],50000,[pointsize,0.7]);
</pre></div>

<img src="./figures/dynamics5.png" alt="./figures/dynamics5">

<p>E uma ampliação de uma pequena região no fractal:
</p>
<div class="example">
<pre class="example">(%i9) evolution2d([f,g],[-0.5,0],300000,[pointsize,0.7], [xcenter,-0.7],
                  [ycenter,-0.3],[xradius,0.1],[yradius,0.1]);
</pre></div>

<img src="./figures/dynamics6.png" alt="./figures/dynamics6">

<p>Um gráfico do triângulo de Sierpinsky, obtido com o jogo do caos:
</p>
<div class="example">
<pre class="example">(%i9) chaosgame([[0, 0], [1, 0], [0.5, sqrt(3)/2]], [0.1, 0.1], 1/2,
                 30000, [pointsize,0.7]);
</pre></div>

<img src="./figures/dynamics7.png" alt="./figures/dynamics7">

<p>O feto de Barnsley, obtido com o Sistema de Funções
Iteradas:
</p>
<div class="example">
<pre class="example">(%i10) a1: matrix([0.85,0.04],[-0.04,0.85])$
(%i11) a2: matrix([0.2,-0.26],[0.23,0.22])$
(%i12) a3: matrix([-0.15,0.28],[0.26,0.24])$
(%i13) a4: matrix([0,0],[0,0.16])$
(%i14) p1: [0,1.6]$
(%i15) p2: [0,1.6]$
(%i16) p3: [0,0.44]$
(%i17) p4: [0,0]$
(%i18) w: [85,92,99,100]$
(%i19) ifs(w,[a1,a2,a3,a4],[p1,p2,p3,p4],[5,0],50000,[pointsize,0.9]);
</pre></div>

<img src="./figures/dynamics8.png" alt="./figures/dynamics8">

<p>Para resolver numericamente a equação diferencial
</p>
<div class="example">
<pre class="example">          dx/dt = t - x^2
</pre></div>

<p>Com valor inicial x(t=0) = 1, no intervalo de t desde 0 até 8, e
com incrementos de 0.1, usa-se:
</p>
<div class="example">
<pre class="example">(%i20) resultados: rk(t-x^2,x,1,[t,0,8,0.1])$
</pre></div>

<p>os resultados ficarão armazenados na lista resultados.
</p>
<p>Para resolver numericamente o sistema:
</p>
<div class="example">
<pre class="example">        dx/dt = 4-x^2-4*y^2     dy/dt = y^2-x^2+1
</pre></div>

<p>para t entre 0 e 4, com valores iniciais -1.25 e 0.75 para (x, y) em t=0:
</p>
<div class="example">
<pre class="example">(%i21) sol: rk([4-x^2-4*y^2,y^2-x^2+1],[x,y],[-1.25,0.75],[t,0,4,0.02])$
</pre></div>

<span id="Item_003a-dynamics_002fnode_002fVisualiza_00e7_00e3o-usando-VTK"></span></div>
<hr>
<div class="header">
<p>
Pr&oacute;ximo: <a href="maxima_152.html" accesskey="n" rel="next">Visualização usando VTK</a>, Anterior: <a href="maxima_150.html" accesskey="p" rel="prev">O pacote dynamics</a>, Acima: <a href="maxima_149.html" accesskey="u" rel="up">dynamics</a> &nbsp; [<a href="maxima_toc.html#SEC_Contents" title="Sum&aacute;rio" rel="contents">Conte&uacute;do</a>][<a href="maxima_218.html" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>]</p>
</div>



</body>
</html>
