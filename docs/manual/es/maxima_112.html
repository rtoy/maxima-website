<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Funciones para la resolución numérica de ecuaciones diferenciales (Manual de Maxima 5.47.0)</title>

<meta name="description" content="Funciones para la resolución numérica de ecuaciones diferenciales (Manual de Maxima 5.47.0)">
<meta name="keywords" content="Funciones para la resolución numérica de ecuaciones diferenciales (Manual de Maxima 5.47.0)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="maxima_toc.html" rel="start" title="Top">
<link href="maxima_304.html" rel="index" title="Índice de Funciones y Variables">
<link href="maxima_toc.html#SEC_Contents" rel="contents" title="Índice general">
<link href="maxima_107.html" rel="up" title="Métodos numéricos">
<link href="maxima_111.html" rel="prev" title="Introducción a la resolución numérica de ecuaciones diferenciales">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
body {color: black; background: white;  margin-left: 8%; margin-right: 13%;
      font-family: "FreeSans", sans-serif}
h1 {font-size: 150%; font-family: "FreeSans", sans-serif}
h2 {font-size: 125%; font-family: "FreeSans", sans-serif}
h3 {font-size: 100%; font-family: "FreeSans", sans-serif}
a[href] {color: rgb(0,0,255); text-decoration: none;}
a[href]:hover {background: rgb(220,220,220);}
div.textbox {border: solid; border-width: thin; padding-top: 1em;
    padding-bottom: 1em; padding-left: 2em; padding-right: 2em}
div.titlebox {border: none; padding-top: 1em; padding-bottom: 1em;
    padding-left: 2em; padding-right: 2em; background: rgb(200,255,255);
    font-family: sans-serif}
div.synopsisbox {
    border: none; padding-top: 1em; padding-bottom: 1em; padding-left: 2em;
    padding-right: 2em; background: rgb(255,220,255);}
pre.example {border: 1px solid rgb(180,180,180); padding-top: 1em;
    padding-bottom: 1em; padding-left: 1em; padding-right: 1em;
    background-color: rgb(238,238,255)}
div.spacerbox {border: none; padding-top: 2em; padding-bottom: 2em}
div.image {margin: 0; padding: 1em; text-align: center}
div.categorybox {border: 1px solid gray; padding-top: 1em; padding-bottom: 1em;
    padding-left: 1em; padding-right: 1em; background: rgb(247,242,220)}
img {max-width:80%; max-height: 80%; display: block; margin-left: auto; margin-right: auto}

-->
</style>

<link rel="icon" href="figures/favicon.ico">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6>"></script>
<script type='text/javascript'>
MathJax = {
  options: {
    skipHtmlTags: {'[-]': ['pre']},
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
};
</script><script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
</head>

<body lang="es" class="tex2jax_ignore">
<div class="section" id="Funciones-para-la-resoluci_00f3n-num_00e9rica-de-ecuaciones-diferenciales">
<div class="header">
<p>
Anterior: <a href="maxima_111.html" accesskey="p" rel="prev">Introducción a la resolución numérica de ecuaciones diferenciales</a>, Subir: <a href="maxima_107.html" accesskey="u" rel="up">Métodos numéricos</a> &nbsp; [<a href="maxima_toc.html#SEC_Contents" title="Índice general" rel="contents">Índice general</a>][<a href="maxima_304.html" title="Índice" rel="index">Índice</a>]</p>
</div>
<span id="Funciones-para-la-resolucion-numerica-de-ecuaciones-diferenciales"></span><h3 class="section">22.5 Funciones para la resolución numérica de ecuaciones diferenciales</h3>



<span id="Item_003a-Numerical_002ees_002fdeffn_002fplotdf"></span><dl class="def">
<dt id="index-plotdf"><span class="category">Función: </span><span><strong>plotdf</strong> <em>(<var>dydx</var>, ...options...)</em><a href='#index-plotdf' class='copiable-anchor'> &para;</a></span></dt>
<dt id="index-plotdf-1"><span class="category">Función: </span><span><strong>plotdf</strong> <em>(<var>dvdu</var>, <code>[</code><var>u</var>,<var>v</var><code>]</code>, ...options...)</em><a href='#index-plotdf-1' class='copiable-anchor'> &para;</a></span></dt>
<dt id="index-plotdf-2"><span class="category">Función: </span><span><strong>plotdf</strong> <em>(<code>[</code><var>dxdt</var>,<var>dydt</var><code>]</code>, ...options...)</em><a href='#index-plotdf-2' class='copiable-anchor'> &para;</a></span></dt>
<dt id="index-plotdf-3"><span class="category">Función: </span><span><strong>plotdf</strong> <em>(<code>[</code><var>dudt</var>,<var>dvdt</var><code>]</code>, <code>[</code><var>u</var>,<var>v</var><code>]</code>, ...options...)</em><a href='#index-plotdf-3' class='copiable-anchor'> &para;</a></span></dt>
<dd><p>Dibuja un campo de direcciones en dos dimensiones <var>x</var> y <var>y</var>.
</p>
<p><var>dydx</var>, <var>dxdt</var> y <var>dydt</var> son expresiones que dependen de <var>x</var> y
<var>y</var>. Además de esas dos variables, las dos expresiones pueden depender de
un conjunto de parámetros, con valores numéricos que son dados por medio
de la opción <code>parameters</code> (la sintaxis de esa opción se explica mas al
frente), o con un rango de posibles valores definidos con la opción
<var>sliders</var>.
</p>
<p>Varias otras opciones se pueden incluir dentro del comando, o
seleccionadas en el menú.  Haciendo click en un punto del gráfico se
puede hacer que sea dibujada la curva integral que pasa por ese punto;
lo mismo puede ser hecho dando las coordenadas del punto con la opción
<code>trajectory_at</code> dentro del comando plotdf. La dirección de
integración se puede controlar con la opción <code>direction</code>, que
acepta valores de <em>forward</em>, <em>backward</em> ou <em>both</em>. El
número de pasos realizado en la integración numérica se controla
con la opción <code>nsteps</code> y el incremento del tiempo en cada paso
con la opción <code>tstep</code>. Se usa el método de Adams Moulton para
hacer la integración numérica; también es posible cambiar para el
método de Runge-Kutta de cuarto orden con ajuste de pasos.
</p>
<p><b>Menú de la ventana del gráfico:</b>
</p>
<p>El menú de la ventana gráfica dispone de las siguientes opciones:
<em>Zoom</em>, que permite cambiar el comportamiento del ratón, de
manera que hará posible el hacer zoom en la región del gráfico
haciendo clic con el botón izquierdo. Cada clic agranda la imagen
manteniendo como centro de la misma el punto sobre el cual se ha hecho
clic. Manteniendo pulsada la tecla <tt class="key">Shift</tt> mientras se hace clic,
retrocede al tamaño anterior. Para reanudar el cálculo de las
trayectorias cuando se hace clic, seleccine la opción <em>Integrate</em>
del menú.
</p>
<p>La opción <em>Config</em> del menú se puede utilizar para cambiar
la(s) EDO(S) y algunos otros ajustes. Después de hacer los cambios, se
debe utilizar la opción <em>Replot</em> para activar los nuevos ajustes.
Si en el campo <em>Trajectory at</em> del menú de diálogo de
<em>Config</em> se introducen un par de coordenadas y luego se pulsa la
tecla <tt class="key">retorno</tt>, se mostrará una nueva curva integral, además de
las ya dibujadas.  Si se selecciona la opción <em>Replot</em>, sólo se
mostrará la última curva integral seleccionada.
</p>
<p>Manteniendo pulsado el botón derecho del ratón mientras se mueve el
cursor, se puede arrastrar el gráfico horizontal y verticalmente.
Otros parámetros, como pueden ser el número de pasos, el valor
inicial de <var>t</var>, las coordenadas del centro y el radio, pueden
cambiarse en el submenú de la opción <em>Config</em>.
</p>
<p>Con la opción <em>Save</em>, se puede obtener una copia del gráfico en
una impresora Postscript o guardarlo en un fichero Postscript. Para
optar entre la impresión o guardar en fichero, se debe seleccionar
<em>Print Options</em> en la ventana de diálogo de <em>Config</em>. Una
vez cubiertos los campos de la ventana de diálogo de <em>Save</em>,
será necesario seleccionar la opción <em>Save</em> del primer menú
para crear el fichero o imprimir el gráfico.
</p>
<p><b>Opciones gráficas:</b>
</p>
<p>La función <code>plotdf</code> admite varias opciones, cada una de las cuales
es una lista de dos o más elementos. El primer elemento es el nombre de
la opción, y el resto está formado por el valor o valores asignados
a dicha opción.
</p>
<p>La función <code>plotdf</code> reconoce las siguientes opciones:
</p>
<ul>
<li> <em>tstep</em> establece la amplitud de los incrementos en la
variable independiente <var>t</var>, utilizados para calcular la curva
integral. Si se aporta sólo una expresión <var>dydx</var>, la variable
<var>x</var> será directamente proporcional a <var>t</var>.
El valor por defecto es 0.1.

</li><li> <em>nsteps</em> establece el número de pasos de longitud
<code>tstep</code> que se utilizarán en la variable independiente para
calcular la curva integral.
El valor por defecto es 100.

</li><li> <em>direction</em> establece la dirección de la variable
independiente que será seguida para calcular una curva integral.
Valores posibles son: <code>forward</code>, para hacer que la variable
independiente aumente <code>nsteps</code> veces, con incrementos <code>tstep</code>;
<code>backward</code>, para hacer que la variable independiente
disminuya; <code>both</code>, para extender la curva integral <code>nsteps</code>
pasos hacia adelante y <code>nsteps</code> pasos hacia atrás.
Las palabras <code>right</code> y <code>left</code> se pueden utilizar como
sinónimos de <code>forward</code> y <code>backward</code>.
El valor por defecto es <code>both</code>.

</li><li> <em>tinitial</em> establece el valor inicial de la variable
<var>t</var> utilizado para calcular curvas integrales. Puesto que las
ecuaciones diferenciales son autónomas, esta opción sólo
aparecerá en los gráficos de las curvas como funciones de <var>t</var>.
El valor por defecto es 0.

</li><li> <em>versus_t</em> se utiliza para crear una segunda ventana
gráfica, con el gráfico de una curva integral, como dos funciones
<var>x</var>, <var>y</var>, de variable independiente <var>t</var>. Si se le da a
<code>versus_t</code> cualquier valor diferente de 0, se mostrará la
segunda ventana gráfica, la cual incluye otro menú, similar
al de la ventana principal.
El valor por defecto es 0.

</li><li> <em>trajectory_at</em> establece las coordenadas <var>xinitial</var>
y <var>yinitial</var> para el extremo inicial de la curva integral.
No tiene asignado valor por defecto.

</li><li> <em>parameters</em> establece una lista de parámetros,
junto con sus valores numéricos, que son utilizados en la
definición de la ecuación diferencial. Los nombres de los
parámetros y sus valores deben escribirse en formato de cadena
de caracteres como una secuencia de pares <code>nombre=valor</code>
separados por comas.

</li><li> <em>sliders</em> establece una lista de parámetros que
se cambiarán interactivamente utilizando barras de deslizamiento,
así como los rangos de variación de dichos parámetros.
Los nombres de los parámetros y sus rangos deben escribirse en formato
de cadena de caracteres como una secuencia de pares <code>nombre=min:max</code>
separados por comas.

</li><li> <em>xfun</em> establece una cadena de caracteres con funciones
de <var>x</var> separadas por puntos y comas para ser representadas por
encima del campo de direcciones. Estas funciones serán interpretadas
por Tcl, no por Maxima.

</li><li> <em>xradius</em> es la mitad de la longitud del rango de valores
a representar en la dirección x.
El valor por defecto es 10.

</li><li> <em>yradius</em> es la mitad de la longitud del rango de valores
a representar en la dirección y.
El valor por defecto es 10.

</li><li> <em>xcenter</em> es la coordenada x del punto situado en el centro
del gráfico.
El valor por defecto es 0.

</li><li> <em>ycenter</em> es la coordenada y del punto situado en el centro
del gráfico.
El valor por defecto es 0.

</li><li> <em>width</em> establece el ancho de la ventana gráfica en
píxeles.
El valor por defecto es 500.

</li><li> <em>height</em> establece la altura de la ventana gráfica en
píxeles.
El valor por defecto es 500.

</li></ul>

<p><b>Ejemplos:</b>
</p>
<p>NOTA: Dependiendo de la interface que se use para Maxima, las funciones
que usan <code>openmath</code>, incluida <code>plotdf</code>, pueden desencadenar un
fallo si terminan en punto y coma, en vez del símbolo de
dólar. Para evitar problemas, se usará el símbolo de
dólar en todos ejemplos.
</p>
<ul>
<li> Para mostrar el campo de direcciones de la ecuación diferencial
<em class='tex2jax_process'>\(y' = exp(-x) + y\)</em> y la solución que pasa por <em class='tex2jax_process'>\((2, -0.1)\)</em>:
<div class="example">
<pre class="example">(%i1) load(&quot;plotdf&quot;)$

(%i2) plotdf(exp(-x)+y,[trajectory_at,2,-0.1]);
</pre></div>

<img src="./figures/plotdf1.png" alt="./figures/plotdf1">

</li><li> Para mostrar el campo de direcciones de la ecuación 
<em class='tex2jax_process'>\(diff(y,x) = x - y^2\)</em> y la solución de condición
inicial <em class='tex2jax_process'>\(y(-1) = 3\)</em>, se puede utilizar la sentencia:
<div class="example">
<pre class="example">(%i3) plotdf(x-y^2,[xfun,&quot;sqrt(x);-sqrt(x)&quot;],
          [trajectory_at,-1,3], [direction,forward],
          [yradius,5],[xcenter,6]);
</pre></div>
<p>El gráfico también muestra la función <em class='tex2jax_process'>\(y = sqrt(x)\)</em>.
</p>
<img src="./figures/plotdf2.png" alt="./figures/plotdf2">

</li><li> El siguiente ejemplo muestra el campo de direcciones de un oscilador
armónico, definido por las ecuaciones <em class='tex2jax_process'>\(dx/dt = y\)</em> y
<em class='tex2jax_process'>\(dy/dt = -k*x/m\)</em>, y la curva integral que pasa por
<em class='tex2jax_process'>\((x,y) = (6,0)\)</em>, con una barra de deslizamiento que 
permitirá cambiar el valor de <em class='tex2jax_process'>\(m\)</em> interactivamente
(<em class='tex2jax_process'>\(k\)</em> permanece fijo a 2):
<div class="example">
<pre class="example">(%i4) plotdf([y,-k*x/m],[parameters,&quot;m=2,k=2&quot;],
            [sliders,&quot;m=1:5&quot;], [trajectory_at,6,0]);
</pre></div>

<img src="./figures/plotdf3.png" alt="./figures/plotdf3">

</li><li> Para representar el campo de direcciones de la ecuación de
Duffing, <em class='tex2jax_process'>\(m*x''+c*x'+k*x+b*x^3 = 0\)</em>, se introduce la
variable <em class='tex2jax_process'>\(y=x'\)</em> y se hace:
<div class="example">
<pre class="example">(%i5) plotdf([y,-(k*x + c*y + b*x^3)/m],
              [parameters,&quot;k=-1,m=1.0,c=0,b=1&quot;],
              [sliders,&quot;k=-2:2,m=-1:1&quot;],[tstep,0.1]);
</pre></div>

<img src="./figures/plotdf4.png" alt="./figures/plotdf4">

</li><li> El campo de direcciones de un péndulo amortiguado,
incluyendo la solución para condiciones iniciales dadas,
con una barra de deslizamiento que se puede utilizar para
cambiar el valor de la masa, <em class='tex2jax_process'>\(m\)</em>, y con el gráfico
de las dos variables de estado como funciones del tiempo:

<div class="example">
<pre class="example">(%i6) plotdf([y,-g*sin(x)/l - b*y/m/l],
         [parameters,&quot;g=9.8,l=0.5,m=0.3,b=0.05&quot;],
         [trajectory_at,1.05,-9],[tstep,0.01],
         [xradius,6],[yradius,14],
         [xcenter,-4],[direction,forward],[nsteps,300],
         [sliders,&quot;m=0.1:1&quot;], [versus_t,1]);
</pre></div>

<img src="./figures/plotdf5.png" alt="./figures/plotdf5"><img src="./figures/plotdf6.png" alt="./figures/plotdf6">

</li></ul>

</dd></dl>



<span id="Item_003a-Numerical_002ees_002fdeffn_002fploteq"></span><dl class="def">
<dt id="index-ploteq"><span class="category">Función: </span><span><strong>ploteq</strong> <em>(<var>exp</var>, ...options...)</em><a href='#index-ploteq' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>Dibuja curvas equipotenciales para <var>exp</var>, que debe ser una expresión
dependiente de dos variables. Las curvas se obtienen integrando la ecuación
diferencial que define las trayectorias ortogonales a las soluciones del 
sistema autónomo que se obtiene del gradiente de la expresión dada.
El dibujo también puede mostrar las curvas integrales de ese sistema
de gradientes (opción <code>fieldlines</code>).
</p>
<p>Este programa también necesita Xmaxima, incluso si se ejecuta Maxima desde
una consola, pues el dibujo se creará por el código Tk de Xmaxima.
Por defecto, la región dibujada estará vacía hasta que el
usuario haga clic en un punto, dé sus coordenadas a través del menú o
mediante la opción <code>trajectory_at</code>.
</p>
<p>La mayor parte de opciones aceptadas por <code>plotdf</code> se pueden utilizar
también con <code>ploteq</code> y el aspecto del interfaz es el mismo que el
descrito para <code>plotdf</code>.
</p>
<p>Ejemplo:
</p>
<div class="example">
<pre class="example">(%i1) V: 900/((x+1)^2+y^2)^(1/2)-900/((x-1)^2+y^2)^(1/2)$
(%i2) ploteq(V,[x,-2,2],[y,-2,2],[fieldlines,&quot;blue&quot;])$
</pre></div>

<p>Haciendo clic sobre un punto se dibujará la curva equipotencial que pasa por
ese punto (en rojo) y la trayectoria ortogonal (en azul).
</p>
</dd></dl>



<span id="Item_003a-Numerical_002ees_002fdeffn_002frk"></span><dl class="def">
<dt id="index-rk"><span class="category">Función: </span><span><strong>rk</strong> <em>(<var>ODE</var>, <var>var</var>, <var>initial</var>, <var>dominio</var>)</em><a href='#index-rk' class='copiable-anchor'> &para;</a></span></dt>
<dt id="index-rk-1"><span class="category">Función: </span><span><strong>rk</strong> <em>([<var>ODE1</var>,...,<var>ODEm</var>], [<var>v1</var>,...,<var>vm</var>], [<var>init1</var>,...,<var>initm</var>], <var>dominio</var>)</em><a href='#index-rk-1' class='copiable-anchor'> &para;</a></span></dt>
<dd>
<p>La primera forma se usa para resolver numéricamente una ecuación
diferencial ordinaria de primer orden (EDO), y la segunda forma resuelve
numéricamente un sistema de <var>m</var> de esas ecuaciones, usando el método
de Runge-Kutta de cuarto orden. <var>var</var> representa la variable dependiente.
EDO debe ser una expresión que dependa únicamente de las variables
independiente y dependente, y define la derivada de la variable dependiente
en función de la variable independiente.
</p>
<p>La variable independiente se representa con <var>dominio</var>, que debe ser
una lista con cuatro elementos, como por ejemplo:
</p><div class="example">
<pre class="example">[t, 0, 10, 0.1]
</pre></div>
<p>el primer elemento de la lista identifica la variable independiente, el
segundo y tercer elementos son los valores inicial y final para esa
variable, y el último elemento da el valor de los incrementos que
deberán ser usados dentro de ese intervalo.
</p>
<p>Si se van a resolver <var>m</var> ecuaciones, deberá haber <var>m</var>
variables dependientes <var>v1</var>, <var>v2</var>, ..., <var>vm</var>. Los valores
iniciales para esas variables serán <var>inic1</var>,
<var>inic2</var>, ..., <var>inicm</var>. Continuará existiendo apenas una
variable independiente definida por la lista <var>domain</var>, como en
el caso anterior. <var>EDO1</var>, ..., <var>EDOm</var> son las expresiones que
definen las derivadas de cada una de las variables dependientes en
función de la variable independiente. Las únicas variables que
pueden aparecer en cada una de esas expresiones son la variable
independiente y cualquiera de las variables dependientes. Es importante
que las derivadas <var>EDO1</var>, ..., <var>EDOm</var> sean colocadas en la lista
en el mismo orden en que fueron agrupadas las variables dependientes;
por ejemplo, el tercer elemento de la lista será interpretado como la
derivada de la tercera variable dependiente.
</p>
<p>El programa intenta integrar las ecuaciones desde el valor inicial de la
variable independiente, hasta el valor final, usando incrementos
fijos. Si en algún paso una de las variables dependientes toma un
valor absoluto muy grande, la integración será suspendida en ese
punto.  El resultado será una lista con un número de elementos igual
al número de iteraciones realizadas. Cada elemento en la lista de
resultados es también una lista con <var>m</var>+1 elementos: el valor de
la variable independiente, seguido de los valores de las variables
dependientes correspondientes a ese punto.
</p>
</dd></dl>




</div>
<hr>
<div class="header">
<p>
Anterior: <a href="maxima_111.html" accesskey="p" rel="prev">Introducción a la resolución numérica de ecuaciones diferenciales</a>, Subir: <a href="maxima_107.html" accesskey="u" rel="up">Métodos numéricos</a> &nbsp; [<a href="maxima_toc.html#SEC_Contents" title="Índice general" rel="contents">Índice general</a>][<a href="maxima_304.html" title="Índice" rel="index">Índice</a>]</p>
</div>


<a href='js_licenses.html' rel='jslicense'><small>Información de licencia de JavaScript</small></a>
</body>
</html>
